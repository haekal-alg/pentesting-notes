## What is SSTI?
Server-side template injection is when an attacker is able to use native template syntax to inject a malicious payload into a template, which is then executed server-side.

## What is the impact?
On worst case scenario, an attacker can gain **RCE** but often, this vulnerability can be used as basis for numerous other attacks, potentially gaining **read access** to sensitive data and arbitrary files on the server.

## How can it occur?
Server-side template injection vulnerabilities arise when user input is **concatenated** into templates rather than being **passed** in as data.

## Constructing SSTI
### 1. Detect
Fuzzing -> `${{<%[%'"}}%\`
1. **Plaintext context:** can be mistaken with [XSS](XSS.md) but using a mathematical expression we can test a potential entry point for SSTI.
	```
	http://vulnerable-website.com/?username=${7*7}
	```
	If the result contains 49 (vary depending the template engine), it's a good proof that the result is being evaluated server-side.
2. **Code context:** first, establish that the parameter doesn't contain a direct XSS vulnerability by injecting arbitrary HTML into the value.
	```
	http://vulnerable-website.com/?greeting=data.username<tag>
	```
	returns a blank output, encoded tags, or an error message.
	then try and break out of the statement using common templating syntax and attempt to inject arbitrary HTML after it:
	```
	http://vulnerable-website.com/?greeting=data.username}}<tag>
	```
	if the output is rendered correctly, along with the arbitrary HTML, this is a key indication that a server-side template injection vulnerability is present. 
	```
	Hello Carlos<tag>
	```

### 2. Identify
Identify the template engine.


### 3. Exploit
https://book.hacktricks.xyz/pentesting-web/ssti-server-side-template-injection

## Resource
1. https://portswigger.net/web-security/server-side-template-injection